# 셀간격조절 컨트롤

만들려고 생각은 했었다. 하지만 구지 필요한가 라는 생각도 들긴 했었고 만들 방법이 생각나지 않았다. 그러던중 메일을 받았다. 메일 내용은 셀간격이 너무 짤고 처리할 문자열
길이가 길어 처리하는데 불편하다는 것이다. 별로 만들 생각은 없었지만 그때부터 어떻게 만들까 생각을 시작했다. 요구사항이 있으면 만들어야지.

처음 고민한 것은 어디에 저장할 것인가이다. 셀간격이란 요소 runtime상에서는 전혀 필요 없는 정보이다. 이것을 sheet에 선언하는 것은 별로 안 좋은 생각 같이 보였다. 결국 생각한 방법은 Window의 SerializeField로 저장하는 방법이다. 윈도우 자체가 각 셀의 넓이 요소를 가지고 표현하게 하면 되지 않는가?

``` csharp
public class DataSheetWindow : EditorWindow{
    .
    [SerializeField]
    List<string> guidKeyStore = new List<string>();

    [SerializeField]
    List<string> widthInfoStore = new List<string>();

    Dictionary<string, List<float>> m_cellDic;
    .
    .
    .
}
```

각 sheet의 guid를 key로 쓰고 셀의 정보를 저장할 List<float>을 사용했다. 근데 이렇게 사용하려면 문제점이 딕셔너리는 SerialzeField가 먹히질 않는다. 위처럼 SerialzeField을 위한 List를 선언해야 하고 OnEnable, OnDisable에서 데이터를 Dicionary로 서로 변경해 줘야 한다. ISerializationCallbackReceiver을 써도 될것 같긴하다.

Disable에서는 dicionary에 있는 정보들을 List에 넣어줘야 한다.

```csharp
    .
    .
    .
    private void OnDisable()
    {
        guidKey.Clear();
        cellInfo.Clear();
        foreach(var pair in cellWidthInfoDic)
        {
            guidKey.Add(pair.Key);
            var st = "";
            foreach(var s in pair.Value)
            {
                if (st.Length != 0)
                    st += ",";
                st += s;
            }
            cellInfo.Add(st);
        }
    }
    .
    .
    .
```